<?php

//require_once PUMPCMS_SYSTEM_PATH . '/pumpimage.php';
//require_once PUMPCMS_SYSTEM_PATH . '/pumpfile.php';
require_once PUMPCMS_SYSTEM_PATH . '/systeminit.php';
require_once PUMPCMS_SYSTEM_PATH . '/db.php';
require_once PUMPCMS_SYSTEM_PATH . '/db_pdo.php';
require_once PUMPCMS_SYSTEM_PATH . '/benchmark.php';
require_once PUMPCMS_SYSTEM_PATH . '/config.php';
require_once PUMPCMS_SYSTEM_PATH . '/model.php';
require_once PUMPCMS_SYSTEM_PATH . '/main.php';
require_once PUMPCMS_SYSTEM_PATH . '/controller.php';
require_once PUMPCMS_SYSTEM_PATH . '/abort.php';
require_once PUMPCMS_SYSTEM_PATH . '/dbset.php';
require_once PUMPCMS_SYSTEM_PATH . '/pumpform.php';
require_once PUMPCMS_SYSTEM_PATH . '/pumpformconfig.php';
require_once PUMPCMS_SYSTEM_PATH . '/pumpormap.php';
require_once PUMPCMS_SYSTEM_PATH . '/pumpormap_util.php';
require_once PUMPCMS_SYSTEM_PATH . '/util.php';
require_once PUMPCMS_SYSTEM_PATH . '/siteinfo.php';
require_once PUMPCMS_SYSTEM_PATH . '/userinfo.php';
require_once PUMPCMS_SYSTEM_PATH . '/menu.php';
require_once PUMPCMS_SYSTEM_PATH . '/pumpimage.php';
require_once PUMPCMS_SYSTEM_PATH . '/notification.php';
require_once PUMPCMS_SYSTEM_PATH . '/wp_compatible.php';
require_once PUMPCMS_APP_PATH . '/module/user/class/actionlog.php';
require_once PUMPCMS_SYSTEM_PATH . '/debug.php';

class Installer {
	public function run() {
	    
	    PC_Config::set('no_db', '1');
	    
		$main = new PC_Main();
	    echo  ' debug 1.2 ';
	        $this->set_config();
	    echo  ' debug 1.1 ';
		$main->setup();
	    echo  ' debug 1 ';
		$main->check_site();
	    echo  ' debug 2 ';
		$main->check_lang();
	    echo  ' debug 3 ';
		$main->render = new PC_Render();
	    echo  ' debug 4 ';
		$main->analyze_url();
	    echo  ' debug 5 ';
		$main->execute();
	    echo  ' debug 6 ';
		$main->render->render();
		exit();
	}
    
    public function set_config() {
	global $pc_config;
	$service_url = PC_Util::get_service_base_path();
	PC_Config::set('base_url', 'http://' . $_SERVER['SERVER_NAME'] . $service_url);

	$pc_config['site_config_catchall'] = 1;
	$pc_config['site_config'] = array(
        );
	$pc_config['site_config'] = array(
	  1 => array('site_title' => 'PumpkinCMS',
		     'theme' => 'default',),
        );					  
    }
}
